(()=>{"use strict";var e={116:(e,r,t)=>{require("core-js/stable"),require("regenerator-runtime/runtime");const n=require("express");var o=t.n(n);const a=require("mongoose"),s=require("body-parser"),i=require("cors");var u=t.n(i);const c=require("compression");var p=t.n(c);const f=require("express-fileupload");var d=t.n(f);const m=require("helmet");var l=t.n(m);const h=require("hsts");var v=t.n(h);const g=require("express-enforces-ssl");var y=t.n(g);const w=require("cookie-session");var b=t.n(w);const x=require("moment-timezone");var R=t.n(x);require("pino-http");const k=require("@supercharge/request-ip"),j=require("rate-limiter-flexible");function q(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function P(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?q(Object(t),!0).forEach((function(r){E(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):q(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function E(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const C=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return P({error:e,message:r},t)},O=JSON.parse('{"DH":{"v6":"Esse endpoint não existe. Verifique o método ou a escrita e tente novamente.","U6":"Servidor online."},"qQ":{"r":"Você atingiu o limite de requests ao servidor.","H":["/api/status","/api/status/","/api/change/avatar","/api/change/avatar/","/api/storage/upload","/api/storage/upload/","/api/users/register","/api/users/register/","/api/users/login","/api/users/login/"]},"Iq":{"nh":"Seu token de autorização e de atualização não podem ser nulos.","bw":"Seu token de autorização não é válido.","R1":"Você não está permitido para acessar este app.","UX":"Seu token expirou e não é mais válido. Faça login.","o8":"Não foi possível validar seu token.","hO":["noapp","lastpwd","ppt"],"UF":"Você não tem permissões necessárias para isso."},"sC":{"b6":{"lB":"O usuário não pode ser nulo.","kE":"O usuário deve ter no máximo 13 caracteres.","fg":"O usuário só pode ter letras e números."},"Do":{"l":"O email não pode ser nulo.","Q":"Este email não é válido."},"Bj":{"lB":"A senha não pode ser nula.","kE":"A senha deve ter no mínimo 10 caracteres.","fK":"A senha deve ter pelo menos uma letra minúscula, maiúscula, número e símbolo."},"fS":{"D":"As senhas devem ser iguais."},"nP":{"Wt":"O agente não pode ser nulo.","ip":"IP inválido.","l2":"App inválido.","FK":"refreshToken inválido."}},"fR":{"Af":"A operação foi concluída com sucesso.","rV":"Não foi possível concluir esta operação. Tente novamente.","yc":"Houveram erros críticos, contate um administrador.","f1":"O campo necessário não pode ser nulo.","TE":"Nenhum campo pode ser nulo."},"rC":{"z2":{"cq":"Seu usuário foi criado com sucesso. Verifique seu email.","To":"Não foi possível criar seu usuário. Tente novamente.","TX":"Usuário ou email já cadastrados.","Hw":"https://firebasestorage.googleapis.com/v0/b/gepetoservices.appspot.com/o/user_image.png?alt=media&token=be333301-d240-47cf-9105-831881fe10ba"},"UG":{"kU":"Seu email já foi confirmado.","s4":"Não foi possível confirmar seu email. Tente novamente.","Gh":"Seu email foi confirmado com sucesso."},"x4":{"Zg":"Confirme seu email antes de tentar fazer login.","im":"Este usuário foi banido e não poderá acessar os serviços.","P$":"Verifique sua senha e tente novamente.","az":"Logado com sucesso.","w3":"Não foi possível encontrar seu usuário."},"m":{"r":{"r5":"Avatar inválido. Seu avatar só pode ser uma imagem .png, .jpg ou .jpeg.","GZ":"Não foi possível salvar seu avatar.","K8":"Avatar alterado com sucesso.","iH":"Não foi possível trocar seu avatar.","_D":"Seu arquivo não pode ter mais que 3 MB."},"B":{"gH":"Confirme esse pedido no seu email.","Km":"Não foi possível alterar sua senha.","o9":"Não foi possível enviar seu email de confirmação."}},"VG":{"U8":"Seus dados não foram encontrados.","sg":"Código de recuperação invalido.","JU":"2FA desativado com sucesso.","Gi":"Sua verificação de dois fatores já está ativa.","Fe":"Sua verificação de dois fatores não está ativa.","cB":"Não foi possível ativar sua verificação de duas etapas. Tente novamente.","am":"Verificação de dois fatores ativada.","R0":"Verificado com sucesso.","qI":"Código inválido."},"T":{"x":"Autenticado com sucesso.","D":"Não autenticado."},"bi":{"R":"Você precisa pedir uma atualização pelo mesmo app que fez login.","v":"Token atualizado com sucesso."}},"i7":{"A":"Status obtido com sucesso."},"tO":{"Pd":{"$":"Não foi possível deixar seu arquivo público ou seu arquivo não existe. Tente novamente."},"TL":{"Yc":"Você não é dono deste arquivo ou ele não existe.","Qr":"Você não é dono deste arquivo.","LZ":"Você não tem permissão para isto."},"ws":{"K8":"Você alcançou seu limite de 7 arquivos armazenados. Delete algum caso queira liberar espaço.","nb":"Não foi possível verificar sua cota. Tente novamente.","OW":"Seu upload foi cancelado devido a um erro. Tente novamente.","EQ":"Houve um erro e não foi possível cancelar seu upload. Contate um administrador.","_D":"Seu arquivo não pode ter mais que 5 MB.","r5":"O tipo do arquivo só pode ser: vídeo, imagem, áudio ou texto."}}}');t(334).config(),R()().locale("pt-br"),R()().tz("America/Maceio");var T=new j.RateLimiterMemory({points:50,duration:1800,inmemoryBlockOnConsumed:200,inmemoryBlockDuration:30}),A=new j.RateLimiterMemory({points:5,duration:1800,inmemoryBlockOnConsumed:10,inmemoryBlockDuration:30});function S(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";if("normal"!==r){var t={"Retry-After":e.msBeforeNext/1e3,"X-RateLimit-Limit":5,"X-RateLimit-Remaining":e.remainingPoints,"X-RateLimit-Reset":R()(R()()+e.msBeforeNext).format("DD/MM/YYYY hh:mm:ss [GMT-3]")};return t}var n={"Retry-After":e.msBeforeNext/1e3,"X-RateLimit-Limit":50,"X-RateLimit-Remaining":e.remainingPoints,"X-RateLimit-Reset":R()(R()()+e.msBeforeNext).format("DD/MM/YYYY hh:mm:ss [GMT-3]")};return n}const I=require("@k3rn31p4nic/google-translate-api");var L=t.n(I);const D=require("xss-filters");var _=t.n(D);const U=require("pino"),M=t.n(U)()({level:"debug",prettyPrint:{levelFirst:!0,colorize:!0}});var V=(0,n.Router)();V.get("/",(function(e,r){var t=e.query,n=t.text,o=t.from,a=t.to;if(!n||!a)return r.status(400).json(C(!0,O.fR.TE));o=1==!o?o:_().uriQueryInHTMLData(o),a=_().uriQueryInHTMLData(a),L()(n,{from:o||"auto",to:a}).then((function(e){return r.json(C(!1,e))})).catch((function(e){M.error(e.message),L()(e.message,{from:"en",to:"pt"}).then((function(e){return r.status(500).json(C(!0,e.text))})).catch((function(e){return M.error(e.message),r.status(500).json(C(!0,O.fR.rV))}))}))}));const N=V,z=require("firebase-admin");var X=t.n(z);t(334).config();var B={type:"service_account",project_id:"gepetoservices",private_key_id:process.env.PKID,private_key:process.env.PK.replace(/\\n/g,"\n"),client_email:process.env.CE,client_id:process.env.CID,auth_uri:"https://accounts.google.com/o/oauth2/auth",token_uri:"https://oauth2.googleapis.com/token",auth_provider_x509_cert_url:"https://www.googleapis.com/oauth2/v1/certs",client_x509_cert_url:process.env.CURL};X().initializeApp({credential:X().credential.cert(B),databaseURL:"https://gepetoservices.firebaseio.com",storageBucket:"gepetoservices.appspot.com"});const Q=X();function G(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}const H=function(){var e,r=(e=regeneratorRuntime.mark((function e(r,t){var n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,o=[];case 2:if(!(n<t)){e.next=17;break}return n++,e.prev=4,e.next=7,r();case 7:return a=e.sent,o.push({try:n,error:!1,data:a}),e.abrupt("break",17);case 12:e.prev=12,e.t0=e.catch(4),o.push({try:n,error:!0,data:e.t0.message});case 15:e.next=2;break;case 17:return e.abrupt("return",o);case 18:case"end":return e.stop()}}),e,null,[[4,12]])})),function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){G(a,n,o,s,i,"next",e)}function i(e){G(a,n,o,s,i,"throw",e)}s(void 0)}))});return function(e,t){return r.apply(this,arguments)}}();function K(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}R()().locale("pt-br"),R()().tz("America/Maceio");const F=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.endpoint=r||"um endpoint",this.start=R()().valueOf(),this.watchpoints=[],this.end=null,this.executionTime=null}var r,t;return r=e,(t=[{key:"watchpoint",value:function(e){this.watchpoints.push({name:e,start:R()().valueOf(),end:null})}},{key:"watchpointEnd",value:function(e){var r=this.watchpoints.findIndex((function(r){return r.name===e}));this.watchpoints[r]={name:e,start:this.watchpoints[r].start,end:R()().valueOf()}}},{key:"finish",value:function(){this.watchpoints.forEach((function(e){var r=R()(e.end-e.start).format("x [ms.]");M.info("A execução do processo '".concat(e.name,"' gastou ").concat(r))})),this.end=R()().valueOf(),this.executionTime=this.end-this.start;var e=R()(this.end-this.start).format("x [ms.]");M.info("O endpoint '".concat(this.endpoint,"' respondeu em ").concat(e))}}])&&K(r.prototype,t),e}();function Y(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function J(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){Y(a,n,o,s,i,"next",e)}function i(e){Y(a,n,o,s,i,"throw",e)}s(void 0)}))}}var W=(0,n.Router)(),$=Q.storage().bucket();function Z(e){return ee.apply(this,arguments)}function ee(){return(ee=J(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.makePublic();case 3:return e.abrupt("return",{error:!1,message:""});case 6:throw e.prev=6,e.t0=e.catch(0),new Error(O.tO.Pd.$);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}W.get("/",function(){var e=J(regeneratorRuntime.mark((function e(r,t){var n,o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new F(r.baseUrl),o=r.query.filename){e.next=5;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.fR.f1)));case 5:return o=_().uriQueryInHTMLData(o),a=$.file(o),e.next=9,H(Z.bind(void 0,a),2);case 9:if(s=e.sent,i=s.length-1,!0!==s[i].error){e.next=14;break}return n.finish(),e.abrupt("return",t.status(500).json(C(!0,s[i].data)));case 14:return n.finish(),e.abrupt("return",t.json(C(!1,O.fR.Af,{file:a.publicUrl()})));case 16:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}());const re=W;var te=void 0;function ne(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function oe(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){ne(a,n,o,s,i,"next",e)}function i(e){ne(a,n,o,s,i,"throw",e)}s(void 0)}))}}var ae=(0,n.Router)(),se=Q.storage().bucket(),ie=Q.firestore().collection("storageLog");function ue(e,r){return ce.apply(this,arguments)}function ce(){return(ce=oe(regeneratorRuntime.mark((function e(r,t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie.doc(r.headers["x-ip"]).get();case 3:if(!(n=e.sent).exists){e.next=14;break}if(!n.data().uploads.files.includes(t)){e.next=11;break}return e.abrupt("return",{error:!1,message:""});case 11:return e.abrupt("return",{error:!0,message:O.tO.TL.Yc});case 12:e.next=15;break;case 14:return e.abrupt("return",{error:!0,message:O.tO.TL.Qr});case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e.catch(0),new Error(O.fR.rV);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}function pe(e,r){return fe.apply(this,arguments)}function fe(){return(fe=oe(regeneratorRuntime.mark((function e(r,t){var n,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se.file(t).delete();case 3:return e.prev=3,e.next=6,ie.doc(r.headers["x-ip"]).get();case 6:if(!(n=e.sent).exists){e.next=22;break}return o=n.data(),e.prev=9,a=o.uploads.files,s=[],a.forEach((function(e){e!==t&&s.push(e)})),e.next=15,ie.doc(r.headers["x-ip"]).update({uploads:{files:s,quantity:o.uploads.quantity-1}});case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e.catch(9),new Error(O.fR.rV);case 20:e.next=23;break;case 22:return e.abrupt("return",{error:!0,message:O.tO.TL.LZ});case 23:e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(3),new Error(O.fR.rV);case 28:return e.abrupt("return",{error:!1,message:O.fR.Af});case 31:throw e.prev=31,e.t2=e.catch(0),new Error(O.fR.rV);case 34:case"end":return e.stop()}}),e,null,[[0,31],[3,25],[9,17]])})))).apply(this,arguments)}ae.delete("/",function(){var e=oe(regeneratorRuntime.mark((function e(r,t){var n,o,a,s,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new F(r.baseUrl),o=r.query.filename){e.next=5;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.fR.f1)));case 5:return o=_().uriQueryInHTMLData(o),n.watchpoint("isUserOwner"),e.next=9,H(ue.bind(te,r,o),2);case 9:if(a=e.sent,s=a.length-1,!a[s].error){e.next=17;break}return n.watchpointEnd("isUserOwner"),n.finish(),e.abrupt("return",t.status(500).json(C(!0,a[s].data)));case 17:if(!a[s].data.error){e.next=23;break}return n.watchpointEnd("isUserOwner"),n.finish(),e.abrupt("return",t.status(400).json(C(!0,a[s].data.message)));case 23:return n.watchpointEnd("isUserOwner"),e.next=26,H(pe.bind(te,r,o),2);case 26:if(i=e.sent,u=i.length-1,!i[u].error){e.next=33;break}return n.finish(),e.abrupt("return",t.status(500).json(C(!0,i[u].data)));case 33:return n.finish(),e.abrupt("return",t.json(C(i[u].data.error,i[u].data.message)));case 35:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}());const de=ae,me=require("shortid");var le=t.n(me);const he=require("fs");var ve=t.n(he);function ge(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ye(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function we(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){ye(a,n,o,s,i,"next",e)}function i(e){ye(a,n,o,s,i,"throw",e)}s(void 0)}))}}var be=(0,n.Router)(),xe=Q.storage().bucket(),Re=Q.firestore().collection("storageLog");function ke(e){return new Promise(function(){var r=we(regeneratorRuntime.mark((function r(t,n){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Re.doc(e).get().then((function(e){return e.exists&&e.data().uploads.quantity>=7?n(O.tO.ws.K8):t()})).catch((function(e){return M.error(e.message),n(O.tO.ws.nb)}));case 2:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}function je(e,r){return new Promise(function(){var t=we(regeneratorRuntime.mark((function t(n,o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Re.doc(e).get().then(function(){var t=we(regeneratorRuntime.mark((function t(a){var s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a.exists){t.next=6;break}return s=a.data(),t.next=4,Re.doc(e).update({uploads:{quantity:s.uploads.quantity+1,files:[].concat((i=s.uploads.files,function(e){if(Array.isArray(e))return ge(e)}(i)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(i)||function(e,r){if(e){if("string"==typeof e)return ge(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ge(e,r):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[r])}}).then((function(){return n()})).catch((function(e){return M.error(e.message),o(O.fR.rV)}));case 4:t.next=8;break;case 6:return t.next=8,Re.doc(e).set({uploader:e,uploads:{quantity:1,files:[r]}}).then((function(){return n()})).catch((function(e){return M.error(e.message),o(O.fR.rV)}));case 8:case"end":return t.stop()}var i}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())}function qe(e){return new Promise(function(){var r=we(regeneratorRuntime.mark((function r(t,n){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=xe.file(e),r.next=3,o.delete().then((function(){return t(O.tO.ws.OW)})).catch((function(e){return M.error(e.message),n(O.tO.ws.EQ)}));case 3:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}function Pe(e){try{return ve().unlinkSync(e),{error:!1}}catch(e){return M.error(e.message),{error:!0,message:O.fR.rV}}}function Ee(e,r){return new Promise((function(t,n){var o="".concat(process.cwd(),"/temp/").concat(r);e.mv(o,(function(e){return e?(M.error(e.message),n(O.fR.rV)):t(o)}))}))}function Ce(e,r){return new Promise(function(){var t=we(regeneratorRuntime.mark((function t(n,o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,xe.upload(e,{gzip:!0,validation:r}).then((function(){return n()})).catch((function(e){return M.error(e.message),o(O.fR.rV)}));case 2:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())}R()().locale("pt-br"),R()().tz("America/Maceio"),be.post("/",function(){var e=we(regeneratorRuntime.mark((function e(r,t){var n,o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new F(r.baseUrl),r.files){e.next=4;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.fR.f1)));case 4:if(o=r.headers["x-ip"],a=r.files.file,s=["text","image","audio","video"],!(a.size>5242880)){e.next=10;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.tO.ws._D)));case 10:if(s.includes(a.mimetype.split("/")[0])){e.next=13;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.tO.ws.r5)));case 13:i=[],Promise.resolve(i).then(function(){var e=we(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke(o).then((function(){return r})).catch((function(e){throw new Error(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=we(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=R()().format("DD-MM-YYYY_hh-mm-ssa_[".concat(le().generate(),".").concat(a.mimetype.split("/")[1],"]")),r.push(t),e.next=4,Ee(a,t).then((function(e){return r.push(e),r})).catch((function(e){throw new Error(e)}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=we(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ce(r[1],a.md5).then((function(){return r.push("uploaded"),r})).catch((function(e){throw new Error(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then((function(e){var r=Pe(e[1]);if(r.error)throw new Error(r.message);return e})).then(function(){var e=we(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(o,r[0]).then((function(){return n.finish(),t.json(C(!1,O.fR.Af,{filename:r[0]}))})).catch((function(e){throw new Error(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).catch(function(){var e=we(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M.error(r.message),"uploaded"!==i[2]){e.next=6;break}return e.next=4,qe(i[0]).then((function(e){return n.finish(),t.status(500).json(C(!0,e))})).catch((function(e){return n.finish(),t.status(500).json(C(!0,e.message))}));case 4:e.next=8;break;case 6:return n.finish(),e.abrupt("return",t.status(500).json(C(!0,r.message)));case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 15:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}());const Oe=be;var Te=(0,n.Router)();Te.use("/access",re),Te.use("/delete",de),Te.use("/upload",Oe);const Ae=Te,Se=require("axios");var Ie=t.n(Se);const Le=require("form-data");var De=t.n(Le);t(334).config();const _e=function(e){return"https://gepetoservices.herokuapp.com/api".concat(e)};function Ue(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function Me(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){Ue(a,n,o,s,i,"next",e)}function i(e){Ue(a,n,o,s,i,"throw",e)}s(void 0)}))}}R()().locale("pt-br"),R()().tz("America/Maceio");const Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;function r(e,r){return e>199&&e<300?r<1700?"OK":"ALERT":e>299?"ERROR":"UNKNOWN"}function t(){return n.apply(this,arguments)}function n(){return(n=Me(regeneratorRuntime.mark((function t(){var n,o,a,s,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={statusCode:0,timeToRespond:0,classifiedAs:""},o=R()().valueOf(),t.prev=2,t.next=5,Ie().get(_e(e));case 5:return a=t.sent,s=R()().valueOf(),n.statusCode=a.status,n.timeToRespond=Number(R()(s-o).format("x")),n.classifiedAs=r(n.statusCode,n.timeToRespond),t.abrupt("return",n);case 13:return t.prev=13,t.t0=t.catch(2),i=R()().valueOf(),n.timeToRespond=Number(R()(i-o).format("x")),void 0===t.t0.response?n.statusCode=503:n.statusCode=t.t0.response.status,n.classifiedAs=r(n.statusCode,n.timeToRespond),t.abrupt("return",n);case 20:case"end":return t.stop()}}),t,null,[[2,13]])})))).apply(this,arguments)}function o(){return a.apply(this,arguments)}function a(){return(a=Me(regeneratorRuntime.mark((function t(){var n,o,a,s,i,u,c,p=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=p.length>0&&void 0!==p[0]?p[0]:"file",o={statusCode:0,timeToRespond:0,classifiedAs:"",filename:""},(a=new(De())).append(n,(0,he.createReadStream)("".concat(process.cwd(),"/assets/tests/testImage.png"))),s=R()().valueOf(),t.prev=5,t.next=8,Ie().post(_e(e),a,{headers:a.getHeaders()});case 8:return i=t.sent,u=R()().valueOf(),o.statusCode=i.status,o.timeToRespond=Number(R()(u-s).format("x")),o.filename=i.data.filename,o.classifiedAs=r(o.statusCode,o.timeToRespond),t.abrupt("return",o);case 17:return t.prev=17,t.t0=t.catch(5),c=R()().valueOf(),o.timeToRespond=Number(R()(c-s).format("x")),void 0===t.t0.response?o.statusCode=503:o.statusCode=t.t0.response.status,o.classifiedAs=r(o.statusCode,o.timeToRespond),t.abrupt("return",o);case 24:case"end":return t.stop()}}),t,null,[[5,17]])})))).apply(this,arguments)}function s(){return i.apply(this,arguments)}function i(){return(i=Me(regeneratorRuntime.mark((function t(){var n,o,a,s,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={statusCode:0,timeToRespond:0,classifiedAs:""},o=R()().valueOf(),t.prev=2,t.next=5,Ie().delete(_e(e));case 5:return a=t.sent,s=R()().valueOf(),n.statusCode=a.status,n.timeToRespond=Number(R()(s-o).format("x")),n.classifiedAs=r(n.statusCode,n.timeToRespond),t.abrupt("return",n);case 13:return t.prev=13,t.t0=t.catch(2),i=R()().valueOf(),n.timeToRespond=Number(R()(i-o).format("x")),void 0===t.t0.response?n.statusCode=503:n.statusCode=t.t0.response.status,n.classifiedAs=r(n.statusCode,n.timeToRespond),t.abrupt("return",n);case 20:case"end":return t.stop()}}),t,null,[[2,13]])})))).apply(this,arguments)}return{get:t,post:o,del:s}};function Ne(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}var ze=(0,n.Router)();ze.get("/",function(){var e,r=(e=regeneratorRuntime.mark((function e(r,t){var n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new F(r.baseUrl),o={translator:{statusCode:0,timeToRespond:0,classifiedAs:""},upload:{statusCode:0,timeToRespond:0,classifiedAs:""},access:{statusCode:0,timeToRespond:0,classifiedAs:""},delete:{statusCode:0,timeToRespond:0,classifiedAs:""}},e.prev=2,n.watchpoint("translatorTest"),e.next=6,Ve("/translator?text=testando essa API&from=pt&to=en").get().then((function(e){o.translator=e})).catch((function(e){o.translator=e}));case 6:return n.watchpointEnd("translatorTest"),a="",n.watchpoint("uploadTest"),e.next=11,Ve("/storage/upload").post().then((function(e){a=e.filename,o.upload.statusCode=e.statusCode,o.upload.timeToRespond=e.timeToRespond,o.upload.classifiedAs=e.classifiedAs})).catch((function(e){o.upload.statusCode=e.statusCode,o.upload.timeToRespond=e.timeToRespond,o.upload.classifiedAs=e.classifiedAs}));case 11:return n.watchpointEnd("uploadTest"),n.watchpoint("accessTest"),e.next=15,Ve("/storage/access?filename=".concat(a)).get().then((function(e){o.access=e})).catch((function(e){o.access=e}));case 15:return n.watchpointEnd("accessTest"),n.watchpoint("deleteTest"),e.next=19,Ve("/storage/delete?filename=".concat(a)).del().then((function(e){o.delete=e})).catch((function(e){o.delete=e}));case 19:return n.watchpointEnd("deleteTest"),n.finish(),e.abrupt("return",t.json(C(!1,O.i7.A,{storage:{access:o.access,delete:o.delete,upload:o.upload},translator:o.translator})));case 24:return e.prev=24,e.t0=e.catch(2),M.error(e.t0.message),e.abrupt("return",t.status(500).json(C(!0,O.fR.rV)));case 28:case"end":return e.stop()}}),e,null,[[2,24]])})),function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){Ne(a,n,o,s,i,"next",e)}function i(e){Ne(a,n,o,s,i,"throw",e)}s(void 0)}))});return function(e,t){return r.apply(this,arguments)}}());const Xe=ze,Be=require("bcrypt");var Qe=t.n(Be);const Ge=require("validator");var He=t.n(Ge);const Ke=function(e){var r=[],t=new F("validação");return e.forEach((function(e){switch(e.type){case"username":if(He().isEmpty(e.value)){r.push(O.sC.b6.lB);break}if(!He().isLength(e.value,{max:13})){r.push(O.sC.b6.kE);break}if(!He().isAlphanumeric(e.value,["pt-BR"])){r.push(O.sC.b6.fg);break}break;case"email":if(He().isEmpty(e.value)){r.push(O.sC.Do.l);break}if(!He().isEmail(e.value)){r.push(O.sC.Do.Q);break}break;case"password":if(He().isEmpty(e.value)){r.push(O.sC.Bj.lB);break}if(!He().isLength(e.value,{min:10})){r.push(O.sC.Bj.kE);break}if(!He().isStrongPassword(e.value)){r.push(O.sC.Bj.fK);break}break;case"equals":if(He().isEmpty(e.value)){r.push(O.sC.Bj.lB);break}if(He().isEmpty(e.equal)){r.push(O.sC.Bj.lB);break}if(!He().equals(e.value,e.equal)){r.push(O.sC.fS.D);break}}})),t.finish(),r};R()().locale("pt-br"),R()().tz("America/Maceio");var Fe=new a.Schema({username:{type:String,required:!0,unique:!0,max:12},email:{type:String,required:!0,unique:!0,lowercase:!0},password:{type:String,required:!0,select:!1},avatar:{type:String,default:O.rC.z2.Hw},level:{type:Number,default:0},state:{banned:{type:Boolean,default:!1},reason:{type:String},banDate:{type:Number},emailConfirmed:{type:Boolean,default:!1},tfaActivated:{type:Boolean,default:!1}},tfa:{recoverCodes:[String],secret:{hash:{type:String},key:{type:Buffer},iv:{type:Buffer}}},register:{date:{type:Number,default:R()().valueOf()},agent:{type:String,required:!0},ip:{type:String,required:!0}},lastLogin:{date:{type:Number},agent:{type:String},ip:{type:String},token:{type:String},app:{type:String}},apps:[String]});const Ye=(0,a.model)("User",Fe,"users"),Je=require("jsonwebtoken");var We=t.n(Je);const $e=require("redis");t(334).config();var Ze=process.env.REDIS_SERVER,er=(0,$e.createClient)({url:Ze,enable_offline_queue:!1});er.on("connect",(function(){M.info("Conectado ao redis.")})),er.on("error",(function(e){throw M.fatal(e.message)}));const rr=er;function tr(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function nr(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){tr(a,n,o,s,i,"next",e)}function i(e){tr(a,n,o,s,i,"throw",e)}s(void 0)}))}}function or(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function ar(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?or(Object(t),!0).forEach((function(r){sr(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):or(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function sr(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}t(334).config(),R()().locale("pt-br"),R()().tz("America/Maceio");const ir=function(){function e(){return(e=nr(regeneratorRuntime.mark((function e(r){var t,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:"access",n=new Promise((function(e,n){"access"===t?We().verify(r,process.env.ACCESS_TOKEN_SECRET,(function(r,t){return r?"TokenExpiredError"===r.name?n({message:O.Iq.UX,code:401,errCode:"ACCESS_TOKEN_EXPIRED"}):(M.error(r.message),n({message:O.Iq.bw,code:401})):e(t)})):We().verify(r,process.env.REFRESH_TOKEN_SECRET,(function(r,t){if(r)return"TokenExpiredError"===r.name?n({message:O.Iq.UX,code:401,errCode:"ACCESS_TOKEN_EXPIRED"}):(M.error(r.message),n({message:O.Iq.bw,code:401}));rr.get(t.tokenId,(function(r,o){return r?(M.error(r.message),n({message:O.Iq.o8,code:500})):null===o||"true"!==o?n({message:O.Iq.bw,code:401}):e(t)}))}))})),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function r(){return(r=nr(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise((function(e,t){rr.set(r,"false",(function(r){return r?(M.error(r.message),t(r)):e()}))})),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{create:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"access",t="".concat(R()().valueOf(),":").concat((0,me.generate)());if("access"===r)try{var n=We().sign(ar(ar({},e),{},{tokenId:t,type:r}),process.env.ACCESS_TOKEN_SECRET,{expiresIn:"15m"});return{error:!1,token:n}}catch(e){return M.error(e.message),{error:!0,message:e}}else try{var o=We().sign(ar(ar({},e),{},{tokenId:t,type:r}),process.env.REFRESH_TOKEN_SECRET,{expiresIn:"1d"}),a=rr.set(t,"true");return a.error?(M.error(a.error),{error:!0,message:a.error}):{error:!1,token:o}}catch(e){return M.error(e.message),{error:!0,message:e}}},verify:function(r){return e.apply(this,arguments)},revoke:function(e){return r.apply(this,arguments)}}},ur=require("nodemailer"),cr=require("ejs");var pr=t.n(cr);function fr(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}t(334).config();const dr=function(e){var r=e.template,t=e.templateParams,n=e.target,o=e.subject;return new Promise(function(){var e,a=(e=regeneratorRuntime.mark((function e(a,s){var i,u,c,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new F("emails"),e.prev=1,u=(0,ur.createTransport)({host:"smtp.gmail.com",port:465,secure:!0,auth:{user:process.env.MAIL_USER,pass:process.env.MAIL_PASS}}),pr().renderFile("".concat(process.cwd(),"/assets/templates/").concat(r,".ejs"),t,(function(e,r){if(e)return i.finish(),M.error(e.message),s(e);c=r})),e.next=6,u.sendMail({from:"GepetoServices <".concat(process.env.MAIL_USER,">"),to:n,subject:o,html:c});case 6:if(p=e.sent,!(f=p.err)){e.next=12;break}return i.finish(),M.error(f.message),e.abrupt("return",s(f));case 12:return i.finish(),e.abrupt("return",a());case 16:return e.prev=16,e.t0=e.catch(1),i.finish(),M.error(e.t0.message),e.abrupt("return",s(e.t0));case 21:case"end":return e.stop()}}),e,null,[[1,16]])})),function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){fr(a,n,o,s,i,"next",e)}function i(e){fr(a,n,o,s,i,"throw",e)}s(void 0)}))});return function(e,r){return a.apply(this,arguments)}}())};function mr(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function lr(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){mr(a,n,o,s,i,"next",e)}function i(e){mr(a,n,o,s,i,"throw",e)}s(void 0)}))}}var hr=(0,n.Router)();function vr(e,r){return gr.apply(this,arguments)}function gr(){return(gr=lr(regeneratorRuntime.mark((function e(r,t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise(function(){var e=lr(regeneratorRuntime.mark((function e(n,o){var a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ye.find({username:r});case 3:return a=e.sent,e.next=6,Ye.find({email:t});case 6:if(s=e.sent,0!==a.length||0!==s.length){e.next=11;break}return e.abrupt("return",n());case 11:return e.abrupt("return",o(O.rC.z2.TX));case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(0),M.error(e.t0.message),e.abrupt("return",o(e.t0));case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(r,t){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yr(e){return wr.apply(this,arguments)}function wr(){return(wr=lr(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise(function(){var e=lr(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ye.deleteOne({_id:r});case 3:return e.abrupt("return",t());case 6:return e.prev=6,e.t0=e.catch(0),M.error(e.t0.message),e.abrupt("return",n(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(r,t){return e.apply(this,arguments)}}()),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}hr.post("/",function(){var e=lr(regeneratorRuntime.mark((function e(r,t){var n,o,a,s,i,u,c,p,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new F(r.baseUrl),o=r.body,a=o.username,s=o.email,i=o.password,u=o.passwordConfirm,c=r.headers["x-from-app"]||"noapp",p=r.headers["user-agent"],f=r.headers["x-ip"],a&&s&&i&&u){e.next=8;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.fR.TE)));case 8:if(p&&f){e.next=11;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.fR.rV)));case 11:if(["noapp","lastpwd","ppt"].includes(c)){e.next=14;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.Iq.R1)));case 14:if(a=a.toLowerCase(),a=_().uriQueryInHTMLData(a),s=_().uriQueryInHTMLData(s),!((d=Ke([{type:"username",value:a},{type:"email",value:s},{type:"password",value:i},{type:"password",value:u},{type:"equals",value:i,equal:u}])).length>0)){e.next=21;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.fR.rV,{errors:d})));case 21:Promise.resolve([]).then(function(){var e=lr(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vr(a,s).then((function(){return r})).catch((function(e){if(e===O.rC.z2.TX)throw new Error("400:".concat(e));throw new Error("500:".concat(O.fR.rV))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=lr(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe().hash(i,12).then((function(e){return r.push(e),r})).catch((function(){throw new Error("500:".concat(O.fR.rV))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=lr(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Ye({username:a,email:s,password:r[0],register:{agent:p,ip:f},apps:[c]}),e.next=3,t.save().then((function(e){return r.push(e),r})).catch((function(e){throw M.error(e.message),new Error("500:".concat(O.rC.z2.To))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=lr(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r[1]._id,void 0,o=ir().create({id:n,scope:"confirmEmail",newState:!0},"refresh"),!(t=o.error?{error:!0}:{error:!1,token:encodeURIComponent(o.token)}).error){e.next=5;break}return e.next=4,yr(r[1]._id).then((function(){throw new Error("500:".concat(O.fR.rV))})).catch((function(){throw new Error("500:".concat(O.fR.yc))}));case 4:return e.abrupt("return",e.sent);case 5:return r.push(t.token),e.abrupt("return",r);case 7:case"end":return e.stop()}var n,o}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=lr(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dr({template:"emailConfirmation",templateParams:{username:a,link:_e("/users/confirm?t=".concat(r[2]))},target:s,subject:"Confirmação de conta do GepetoServices"}).then((function(){return n.finish(),t.json(C(!1,O.rC.z2.cq))})).catch(lr(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yr(r[1]._id).then((function(){throw new Error("500:".concat(O.rC.z2.To))})).catch((function(){throw new Error("500:".concat(O.fR.yc))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){n.finish();var r=e.message.split(":");return M.error(e.message),t.status(r[0]).json(C(!0,r[1]))}));case 22:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}());const br=hr;function xr(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function Rr(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){xr(a,n,o,s,i,"next",e)}function i(e){xr(a,n,o,s,i,"throw",e)}s(void 0)}))}}t(334).config();var kr=(0,n.Router)();function jr(e){return new Promise(function(){var r=Rr(regeneratorRuntime.mark((function r(t,n){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Ye.findOne({_id:e});case 3:if(!(o=r.sent)){r.next=8;break}return r.abrupt("return",t(o.state));case 8:return r.abrupt("return",n("Usuário inexistente."));case 9:r.next=15;break;case 11:return r.prev=11,r.t0=r.catch(0),M.error(r.t0.message),r.abrupt("return",n(r.t0.message));case 15:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(e,t){return r.apply(this,arguments)}}())}function qr(e,r){return new Promise(function(){var t=Rr(regeneratorRuntime.mark((function t(n,o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ye.updateOne({_id:e},{state:r});case 3:return t.abrupt("return",n());case 6:return t.prev=6,t.t0=t.catch(0),M.error(t.t0.message),t.abrupt("return",o(t.t0.message));case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,r){return t.apply(this,arguments)}}())}function Pr(e,r){return new Promise(function(){var t=Rr(regeneratorRuntime.mark((function t(n,o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ye.updateOne({_id:e},r);case 3:return t.abrupt("return",n());case 6:return t.prev=6,t.t0=t.catch(0),M.error(t.t0.message),t.abrupt("return",o(t.t0.message));case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,r){return t.apply(this,arguments)}}())}kr.get("/",function(){var e=Rr(regeneratorRuntime.mark((function e(r,t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new F(r.baseUrl),o=r.query.t){e.next=5;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.Iq.nh)));case 5:o=decodeURIComponent(o),o=_().uriQueryInHTMLData(o),Promise.resolve([]).then(function(){var e=Rr(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ir().verify(o,"refresh").then((function(e){return r.push(e),r})).catch((function(e){throw new Error("".concat(e.code,":").concat(e.message))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=Rr(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ir().revoke(r[0].tokenId).then((function(){return r})).catch((function(){throw new Error("500:".concat(O.fR.rV))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=Rr(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jr(r[0].id).then(function(){var e=Rr(regeneratorRuntime.mark((function e(o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r[0].scope,e.next="confirmEmail"===e.t0?3:"changePassword"===e.t0?8:11;break;case 3:if(o.emailConfirmed!==r[0].newState){e.next=5;break}throw new Error("400:".concat(O.rC.UG.kU));case 5:return e.next=7,qr(r[0].id,{emailConfirmed:r[0].newState,banned:o.banned,reason:o.reason,banDate:o.banDate}).then((function(){return n.finish(),t.json(C(!1,O.rC.UG.Gh))})).catch((function(){throw new Error("500:".concat(O.rC.UG.s4))}));case 7:return e.abrupt("return",e.sent);case 8:return e.next=10,Pr(r[0].id,{password:r[0].newState}).then((function(){return n.finish(),t.json(C(!1,O.rC.UG.Gh))})).catch((function(){throw new Error("500:".concat(O.rC.UG.s4))}));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){throw new Error("500:".concat(e))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){n.finish();var r=e.message.split(":");return t.status(r[0]).json(C(!0,r[1]))}));case 8:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}());const Er=kr,Cr=require("uuid");t(334),R()().locale("pt-br"),R()().tz("America/Maceio");var Or=Q.firestore().collection("sessions");const Tr=function(){function e(e){return new Promise((function(r,t){Or.doc(e).delete().then((function(){return r()})).catch((function(e){return logger.error(e.message),t(e)}))}))}return{model:function(e){var r=e.uid,t=e.username,n=e.agent,o=e.ip,a=e.tfaValidated,s=e.app,i=e.refreshToken;return He().isEmpty(t)?{error:!0,message:O.sC.b6.lB}:He().isEmpty(n)?{error:!0,message:O.sC.nP.Wt}:He().isIP(o,4)?O.Iq.hO.includes(s)?He().isJWT(i)?{error:!1,session:{uid:r.toString(),username:t,agent:n,ip:o,tfaValidated:a,refreshToken:i,sessionId:(0,Cr.v4)(),loginDate:R()().valueOf(),validUntil:R()().add(1,"day").valueOf()}}:{error:!0,message:O.sC.nP.FK}:{error:!0,message:O.sC.nP.l2}:{error:!0,message:O.sC.nP.ip}},create:function(e){return new Promise((function(r,t){Or.doc(e.sessionId).create(e).then((function(){return r()})).catch((function(e){return logger.error(e.message),t(e)}))}))},verify:function(r){return new Promise((function(t,n){Or.where("refreshToken","==",r).get().then((function(o){if(o.empty)return n({message:O.Iq.bw,code:401});o.forEach((function(o){return o.exists&&We().verify(r,process.env.REFRESH_TOKEN_SECRET,(function(r,a){return r?("TokenExpiredError"===r.name&&e(o.data().sessionId).then((function(){return n({message:O.Iq.UX,code:401})})).catch((function(e){return logger.error(e.message),n({message:O.Iq.UX,code:500})})),n({message:O.Iq.bw,code:401})):t(a)})),n({message:O.Iq.bw,code:401})}))}))}))},revoke:e}};function Ar(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Sr(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function Ir(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){Sr(a,n,o,s,i,"next",e)}function i(e){Sr(a,n,o,s,i,"throw",e)}s(void 0)}))}}t(334).config();var Lr=(0,n.Router)();function Dr(e){return new Promise(function(){var r=Ir(regeneratorRuntime.mark((function r(t,n){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Ye.findOne({username:e},"+password");case 3:return o=r.sent,r.abrupt("return",t(o));case 7:return r.prev=7,r.t0=r.catch(0),console.error(r.t0),r.abrupt("return",n(r.t0));case 11:case"end":return r.stop()}}),r,null,[[0,7]])})));return function(e,t){return r.apply(this,arguments)}}())}function _r(e,r){return new Promise(function(){var t=Ir(regeneratorRuntime.mark((function t(n,o){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Qe().compare(e,r);case 3:return a=t.sent,t.abrupt("return",n(a));case 7:return t.prev=7,t.t0=t.catch(0),console.error(t.t0),t.abrupt("return",o(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r){return t.apply(this,arguments)}}())}function Ur(e){var r=e.id,t=e.agent,n=e.ip,o=e.app,a=e.token;return new Promise(function(){var e=Ir(regeneratorRuntime.mark((function e(s,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ye.updateOne({_id:r},{lastLogin:{date:R()().valueOf(),agent:t,ip:n,app:o,token:a}});case 3:return e.abrupt("return",s());case 6:return e.prev=6,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",i(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(r,t){return e.apply(this,arguments)}}())}function Mr(e,r){return new Promise(function(){var t=Ir(regeneratorRuntime.mark((function t(n,o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.apps.includes(r)){t.next=7;break}return t.next=4,Ye.updateOne({_id:e.id},{apps:[].concat((a=e.apps,function(e){if(Array.isArray(e))return Ar(e)}(a)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(a)||function(e,r){if(e){if("string"==typeof e)return Ar(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ar(e,r):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[r])});case 4:case 7:return t.abrupt("return",n());case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(0),console.error(t.t0),t.abrupt("return",o(t.t0));case 14:case"end":return t.stop()}var a}),t,null,[[0,10]])})));return function(e,r){return t.apply(this,arguments)}}())}R()().locale("pt-br"),R()().tz("America/Maceio"),Lr.post("/",function(){var e=Ir(regeneratorRuntime.mark((function e(r,t){var n,o,a,s,i,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new F(r.baseUrl),o=r.body,a=o.username,s=o.password,i=r.headers["x-from-app"]||"noapp",u=r.headers["user-agent"],c=r.headers["x-ip"],a&&s){e.next=8;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.fR.TE)));case 8:if(O.Iq.hO.includes(i)){e.next=11;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.Iq.R1)));case 11:a=_().uriQueryInHTMLData(a),Promise.resolve([]).then(function(){var e=Ir(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dr(a).then((function(e){if(!e.state.emailConfirmed)throw new Error("401:".concat(O.rC.x4.Zg));if(e.state.banned)throw new Error("400:".concat(O.rC.x4.im));return r.push(e),r})).catch((function(){throw new Error("500:".concat(O.rC.x4.w3))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=Ir(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_r(s,r[0].password).then((function(e){if(e)return r;throw new Error("401:".concat(O.rC.x4.P$))})).catch((function(){throw new Error("401:".concat(O.rC.x4.P$))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=Ir(regeneratorRuntime.mark((function e(r){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ir().create({id:r[0]._id,app:i},"access"),n=ir().create({id:r[0]._id,app:i},"refresh"),!t.error&&!n.error){e.next=4;break}throw new Error("500:".concat(O.fR.rV));case 4:return r.push(t.token),r.push(n.token),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=Ir(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=Tr().model({uid:r[0]._id,username:r[0].username,agent:u,ip:c,tfaValidated:!1,app:i,refreshToken:r[2]})).error){e.next=3;break}throw new Error("400:".concat(t.message));case 3:return e.next=5,Tr().create(t.session).then((function(){return r})).catch((function(e){throw console.error(e),new Error("500:".concat(O.fR.rV))}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=Ir(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ur({id:r[0]._id,agent:u,ip:c,app:i,token:r[2]}).then((function(){return r})).catch((function(){throw new Error("500:".concat(O.fR.yc))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=Ir(regeneratorRuntime.mark((function e(o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Mr(o[0],i).then((function(){return r.session.refreshToken=o[2],n.finish(),t.json(C(!1,O.rC.x4.az,{accessToken:o[1]}))})).catch((function(){throw new Error("500:".concat(O.fR.yc))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){n.finish();var r=e.message.split(":");return t.status(r[0]).json(C(!0,r[1]))}));case 13:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}());const Vr=Lr,Nr=require("memory-cache");var zr=t.n(Nr);function Xr(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Br(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Xr(Object(t),!0).forEach((function(r){Qr(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Xr(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function Qr(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const Gr=function(e){var r=zr().get(e);return null===r?{cached:!1}:{cached:!0,data:Br(Br({},r),{},{cachedData:!0})}};function Hr(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Kr(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function Fr(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){Kr(a,n,o,s,i,"next",e)}function i(e){Kr(a,n,o,s,i,"throw",e)}s(void 0)}))}}t(334).config();const Yr=function(e){var r=e.level;return function(){var e=Fr(regeneratorRuntime.mark((function e(t,n,o){var a,s,i,u,c,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.headers.authorization,s=t.session.refreshToken,i=t.headers["x-from-app"]||"noapp",t.headers["user-agent"],a&&s){e.next=6;break}return e.abrupt("return",n.status(401).json(C(!0,O.Iq.nh)));case 6:if(O.Iq.hO.includes(i)){e.next=8;break}return e.abrupt("return",n.status(401).json(C(!0,O.Iq.R1)));case 8:if(u=a.split(" "),m=2,c=function(e){if(Array.isArray(e))return e}(d=u)||function(e,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var t=[],n=!0,o=!1,a=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(t.push(s.value),!r||t.length!==r);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw a}}return t}}(d,m)||function(e,r){if(e){if("string"==typeof e)return Hr(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Hr(e,r):void 0}}(d,m)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),p=c[0],f=c[1],"Bearer"===p&&f){e.next=11;break}return e.abrupt("return",n.status(401).json(C(!0,O.Iq.bw)));case 11:return e.next=13,ir().verify(f,"access").then(Fr(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ir().verify(s,"refresh").then(function(){var e=Fr(regeneratorRuntime.mark((function e(a){var s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.app===i){e.next=2;break}return e.abrupt("return",n.status(401).json(C(!0,O.Iq.R1)));case 2:if(!(a.level<r)){e.next=4;break}return e.abrupt("return",n.status(401).json(C(!0,O.Iq.UF)));case 4:if(!(s=Gr(a.id)).cached){e.next=10;break}return t.user=s.data,e.abrupt("return",o());case 10:return e.next=12,Ye.findOne({_id:a.id});case 12:if(!(u=e.sent)){e.next=25;break}if(!u.state.banned){e.next=18;break}if(!u.state.reason){e.next=17;break}return e.abrupt("return",n.status(400).json(C(!0,O.rC.x4.im,{reason:u.state.reason})));case 17:return e.abrupt("return",n.status(400).json(C(!0,O.rC.x4.im)));case 18:if(!(u.level<r)){e.next=20;break}return e.abrupt("return",n.status(401).json(C(!0,O.Iq.UF)));case 20:return t.user={id:u._id,username:u.username,email:u.email,level:u.level,avatar:u.avatar,state:u.state,registerDate:u.register.date,app:a.app,cachedData:!1},zr().put(a.id,t.user,3e5),e.abrupt("return",o());case 25:return e.abrupt("return",n.status(401).json(C(!0,O.rC.x4.w3)));case 26:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){return M.error(e.message),n.status(e.code).json(C(!0,e.message))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){return e.errCode||M.error(e.message),n.status(e.code).json(C(!0,e.message))}));case 13:case"end":return e.stop()}var d,m}),e)})));return function(r,t,n){return e.apply(this,arguments)}}()};t(334).config();var Jr=(0,n.Router)();Jr.get("/",Yr({level:0}),(function(e,r){var t=e.headers["x-from-app"]||"noapp";return e.user?e.user.app===t?r.json(C(!1,O.rC.T.x,{user:e.user})):r.status(401).json(C(!0,O.Iq.R1)):r.status(401).json(C(!0,O.rC.T.D))}));const Wr=Jr;function $r(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}var Zr=(0,n.Router)();Zr.get("/",(function(e,r){var t=e.cookies.refreshToken,n=e.headers["x-from-app"]||"noapp";return e.headers["user-agent"],t?["noapp","lastpwd","ppt"].includes(n)?void Promise.resolve([]).then(function(){var e,r=(e=regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ir().verify(t,"refresh").then((function(e){if(e.app!==n)throw new Error("401:".concat(O.rC.bi.R));return r.push(e),r})).catch((function(e){throw new Error("".concat(e.code,":").concat(e.message))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){$r(a,n,o,s,i,"next",e)}function i(e){$r(a,n,o,s,i,"throw",e)}s(void 0)}))});return function(e){return r.apply(this,arguments)}}()).then((function(e){var t=ir().create({id:e[0].id,app:e[0].app},"access");if(t.error)throw new Error("500:".concat(O.fR.rV));return r.json(C(!1,O.rC.bi.v,{accessToken:t.token}))})).catch((function(e){var t=e.message.split(":");return r.status(t[0]).json(C(!0,t[1]))})):r.status(401).json(C(!0,O.Iq.R1)):r.status(401).json(C(!0,O.Iq.nh))}));const et=Zr,rt=require("jimp");var tt=t.n(rt);const nt=require("crypto");var ot=t.n(nt);function at(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function st(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){at(a,n,o,s,i,"next",e)}function i(e){at(a,n,o,s,i,"throw",e)}s(void 0)}))}}t(334).config();var it=(0,n.Router)(),ut=Q.storage().bucket();function ct(e){return pt.apply(this,arguments)}function pt(){return(pt=st(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise(function(){var e=st(regeneratorRuntime.mark((function e(t,n){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=ut.file("".concat(r,".jpg")),e.next=4,o.exists();case 4:a=e.sent,t(a[0]),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),M.error(e.t0.message),n(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(r,t){return e.apply(this,arguments)}}()),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(e){return dt.apply(this,arguments)}function dt(){return(dt=st(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise(function(){var e=st(regeneratorRuntime.mark((function e(t,n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=ut.file("".concat(r,".jpg")),e.next=4,o.delete();case 4:t(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),M.error(e.t0.message),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r,t){return e.apply(this,arguments)}}()),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mt(e){return lt.apply(this,arguments)}function lt(){return(lt=st(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise((function(e,t){var n="".concat(process.cwd(),"/temp/").concat(le().generate(),".").concat(r.mimetype.split("/")[1]);r.mv(n,(function(r){r&&(M.error(r.message),t(r)),e(n)}))})),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ht(e,r){return vt.apply(this,arguments)}function vt(){return(vt=st(regeneratorRuntime.mark((function e(r,t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e,n){tt().read(t).then((function(t){var o="".concat(process.cwd(),"/temp/").concat(r,".jpg");t.resize(128,128).quality(95).write(o,(function(r){r&&(M.error(r.message),n(r)),ve().readFile(o,(function(r,t){r&&(M.error(r.message),n(r));var a=ot().createHash("md5").update(t,"utf8").digest("hex");e({newPath:o,checksum:a})}))}))})).catch((function(e){M.error(e.message),n(e)}))})),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gt(e){try{return ve().unlinkSync(e),{error:!1}}catch(e){return M.error(e.message),{error:!0,message:O.fR.rV}}}function yt(e,r){return wt.apply(this,arguments)}function wt(){return(wt=st(regeneratorRuntime.mark((function e(r,t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise(function(){var e=st(regeneratorRuntime.mark((function e(n,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ut.upload(r,{gzip:!0,validation:t}).then(n()).catch((function(e){M.error(e.message),o(e)}));case 2:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bt(e){return xt.apply(this,arguments)}function xt(){return(xt=st(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Promise(function(){var e=st(regeneratorRuntime.mark((function e(t,n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=ut.file("".concat(r,".jpg")),setTimeout(st(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.makePublic().then(st(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.publicUrl(),e.next=3,Ye.updateOne({_id:r},{avatar:n});case 3:t(n);case 4:case"end":return e.stop()}}),e)})))).catch((function(e){M.error(e.message),n(e)}));case 2:case"end":return e.stop()}}),e)}))),300);case 2:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}it.put("/",Yr({level:0}),function(){var e=st(regeneratorRuntime.mark((function e(r,t){var n,o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new F(r.baseUrl),o=r.user.id,r.files){e.next=5;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.fR.f1)));case 5:if(a=r.files.file,s=a.mimetype.split("/"),!(a.size>3145728)){e.next=10;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.rC.m.r._D)));case 10:if("image"===s[0]&&["png","jpeg"].includes(s[1])){e.next=13;break}return n.finish(),e.abrupt("return",t.status(400).json(C(!0,O.rC.m.r.r5)));case 13:i=[],Promise.resolve(i).then(function(){var e=st(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ct(o).then((function(e){return e&&ft(o).catch((function(){throw new Error("500:".concat(O.rC.m.r.iH))})).then((function(){return r})),r})).catch((function(){throw new Error("500:".concat(O.rC.m.r.iH))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=st(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt(a).then((function(e){return r.push(e),r})).catch((function(){throw new Error("500:".concat(O.fR.rV))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=st(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht(o,r[0]).then((function(e){var t=e.newPath,n=e.checksum;return r.push(t),r.push(n),r})).catch((function(){throw new Error("500:".concat(O.rC.m.r.GZ))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=st(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yt(r[1],r[2]).then((function(){return r})).catch((function(){throw new Error("500:".concat(O.rC.m.r.GZ))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then(function(){var e=st(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bt(o).then((function(e){var o=gt(r[0]),a=gt(r[1]);if(o.error||a.error)throw new Error("500:".concat(O.fR.rV));return n.finish(),t.json(C(!1,O.rC.m.r.K8,{link:e}))})).catch((function(){var e=gt(originalFilePath),r=gt(resizedImagePath);if(e.error||r.error)throw new Error("500:".concat(O.fR.rV))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){n.finish();var r=e.message.split(":");return t.status(r[0]).json(C(!0,r[1]))}));case 15:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}());const Rt=it;function kt(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function jt(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){kt(a,n,o,s,i,"next",e)}function i(e){kt(a,n,o,s,i,"throw",e)}s(void 0)}))}}var qt=(0,n.Router)();function Pt(e,r){return new Promise(function(){var t=jt(regeneratorRuntime.mark((function t(n,o){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ye.findOne({_id:e},"+password");case 3:return a=t.sent,t.next=6,Qe().compare(r,a.password).then((function(e){n(e)})).catch((function(e){M.error(e.message),o(e)}));case 6:t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),M.error(t.t0.message),o(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r){return t.apply(this,arguments)}}())}function Et(e){return new Promise(function(){var r=jt(regeneratorRuntime.mark((function r(t,n){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Qe().hash(e,12);case 3:o=r.sent,t(o),r.next=11;break;case 7:r.prev=7,r.t0=r.catch(0),M.error(r.t0.message),n(r.t0);case 11:case"end":return r.stop()}}),r,null,[[0,7]])})));return function(e,t){return r.apply(this,arguments)}}())}qt.put("/",Yr({level:0}),(function(e,r){var t=new F(e.baseUrl),n=e.body,o=n.password,a=n.newPassword,s=n.newPasswordConfirm;if(!o||!a||!s)return t.finish(),r.status(400).json(C(!0,O.fR.TE));o=_().uriQueryInHTMLData(o),a=_().uriQueryInHTMLData(a),s=_().uriQueryInHTMLData(s);var i=Ke([{type:"password",value:o},{type:"password",value:a},{type:"password",value:s},{type:"equals",value:a,equal:s}]);if(i.length>0)return t.finish(),r.status(400).json(C(!0,O.fR.rV,{errors:i}));Promise.resolve([]).then(function(){var r=jt(regeneratorRuntime.mark((function r(t){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Pt(e.user.id,o).then((function(e){if(e)return t;throw new Error("401:".concat(O.rC.x4.P$))})).catch((function(){throw new Error("401:".concat(O.rC.x4.P$))}));case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).then(function(){var e=jt(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Et(a).then((function(e){return r.push(e),r})).catch((function(){throw new Error("500:".concat(O.rC.m.B.Km))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then((function(r){var t=function(e,r){var t=ir().create({id:e,scope:"changePassword",newState:r},"refresh");return t.error?{error:!0}:{error:!1,link:_e("/users/confirm?t=".concat(encodeURIComponent(t.token)))}}(e.user.id,r[0]);if(!t.error)return r.push(t.link),r;throw new Error("500:".concat(O.rC.m.B.Km))})).then(function(){var n=jt(regeneratorRuntime.mark((function n(o){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,dr({template:"changePassword",templateParams:{username:e.user.username,link:o[1]},target:e.user.email,subject:"Mudança de senha da conta do GepetoServices"}).then((function(){return t.finish(),r.json(C(!1,O.rC.m.B.gH))})).catch((function(){throw new Error("500:".concat(O.rC.m.B.o9))}));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){t.finish();var n=e.message.split(":");return r.status(n[0]).json(C(!0,n[1]))}))}));const Ct=qt;var Ot=(0,n.Router)();Ot.use("/avatar",Rt),Ot.use("/password",Ct);const Tt=Ot,At=require("node-2fa"),St=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"aes-256-ctr";function r(r){try{var t=(0,nt.randomBytes)(32),n=(0,nt.randomBytes)(16),o=(0,nt.createCipheriv)(e,t,n);return{error:!1,hash:Buffer.concat([o.update(r),o.final()]).toString("hex"),key:t,iv:n}}catch(e){return M.error(e.message),{error:!0}}}function t(r){var t=r.hash,n=r.key,o=r.iv;try{var a=(0,nt.createDecipheriv)(e,n,Buffer.from(o,"hex"));return{error:!1,result:Buffer.concat([a.update(Buffer.from(t,"hex")),a.final()]).toString()}}catch(e){return M.error(e.message),{error:!0}}}return{enc:r,dec:t}};function It(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function Lt(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){It(a,n,o,s,i,"next",e)}function i(e){It(a,n,o,s,i,"throw",e)}s(void 0)}))}}t(334).config();var Dt=(0,n.Router)();function _t(e){return new Promise(function(){var r=Lt(regeneratorRuntime.mark((function r(t,n){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Ye.findOne({_id:e});case 3:if(!(o=r.sent).state.tfaActivated){r.next=6;break}return r.abrupt("return",n(O.rC.VG.Gi));case 6:return r.next=8,Ye.updateOne({_id:e},{state:{banned:o.state.banned,reason:o.state.reason,banDate:o.state.banDate,emailConfirmed:o.state.emailConfirmed,tfaActivated:!0}});case 8:return r.abrupt("return",t());case 11:return r.prev=11,r.t0=r.catch(0),M.error(r.t0.message),r.abrupt("return",n(O.fR.rV));case 15:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(e,t){return r.apply(this,arguments)}}())}function Ut(e){return new Promise(function(){var r=Lt(regeneratorRuntime.mark((function r(t,n){var o,a,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:o=[],a=0;case 2:if(!(a<=10)){r.next=9;break}return s=e[a],r.next=6,Qe().hash(s,12).then((function(e){o.push(e)})).catch((function(){return n(O.fR.rV)}));case 6:a++,r.next=2;break;case 9:return r.abrupt("return",t(o));case 10:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}function Mt(e,r,t){return new Promise(function(){var n=Lt(regeneratorRuntime.mark((function n(o,a){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ye.updateOne({_id:e},{tfa:{recoverCodes:r,secret:t}});case 3:return n.abrupt("return",o());case 6:return n.prev=6,n.t0=n.catch(0),M.error(n.t0.message),n.abrupt("return",a(O.rC.VG.cB));case 10:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(e,r){return n.apply(this,arguments)}}())}Dt.get("/",Yr({level:0}),(function(e,r){Promise.resolve([]).then(function(){var r=Lt(regeneratorRuntime.mark((function r(t){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_t(e.user.id).then((function(){return t})).catch((function(e){throw new Error("400:".concat(e))}));case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).then((function(e){var r=function(){for(var e=[],r=0;r<=10;)r++,e.push((0,me.generate)());return e}();return e.push(r),e})).then((function(r){var t=(0,At.generateSecret)({name:"GepetoServices",account:e.user.username});return r.push(t.secret),r.push(t.qr),r})).then(function(){var e=Lt(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ut(r[0]).then((function(e){return r.push(e),r})).catch((function(e){throw new Error("500:".concat(e))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).then((function(e){var r=St().enc(e[1]);if(r.error)throw new Error("500:".concat(O.fR.rV));return e.push({hash:r.hash,key:r.key,iv:r.iv}),e})).then(function(){var t=Lt(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Mt(e.user.id,n[3],n[4]).then((function(){return r.json(C(!1,O.rC.VG.am,{recoverCodes:n[0],qrcode:n[2],tfaCode:n[1]}))})).catch((function(e){throw new Error("500:".concat(e))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){var t=e.message.split(":");return r.status(t[0]).json(C(!0,t[1]))}))}));const Vt=Dt;function Nt(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function zt(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){Nt(a,n,o,s,i,"next",e)}function i(e){Nt(a,n,o,s,i,"throw",e)}s(void 0)}))}}t(334).config();var Xt=(0,n.Router)();function Bt(e){return new Promise(function(){var r=zt(regeneratorRuntime.mark((function r(t,n){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Ye.findOne({_id:e});case 3:if((o=r.sent).state.tfaActivated){r.next=6;break}return r.abrupt("return",n(O.rC.VG.Fe));case 6:return r.abrupt("return",t(o.tfa.secret));case 9:return r.prev=9,r.t0=r.catch(0),M.error(r.t0.message),r.abrupt("return",n(O.fR.rV));case 13:case"end":return r.stop()}}),r,null,[[0,9]])})));return function(e,t){return r.apply(this,arguments)}}())}Xt.get("/",Yr({level:0}),(function(e,r){var t=e.query.code;if(!t)return r.status(400).json(C(!0,O.fR.f1));Promise.resolve([]).then(function(){var r=zt(regeneratorRuntime.mark((function r(t){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Bt(e.user.id).then((function(e){return t.push(e),t})).catch((function(e){throw new Error("400:".concat(e))}));case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).then((function(e){var r=St().dec(e[0]);if(r.error)throw new Error("500:".concat(O.fR.rV));return e.push(r.result),e})).then((function(e){var n=(0,At.verifyToken)(e[1],t);return n&&0===n.delta?r.json(C(!1,O.rC.VG.R0)):r.status(401).json(C(!0,O.rC.VG.qI))})).catch((function(e){M.error(e.message);var t=e.message.split(":");return r.status(t[0]).json(C(!0,t[1]))}))}));const Qt=Xt;function Gt(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}function Ht(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){Gt(a,n,o,s,i,"next",e)}function i(e){Gt(a,n,o,s,i,"throw",e)}s(void 0)}))}}var Kt=(0,n.Router)();function Ft(e){return new Promise(function(){var r=Ht(regeneratorRuntime.mark((function r(t,n){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Ye.findOne({_id:e});case 3:if((o=r.sent).state.tfaActivated){r.next=6;break}return r.abrupt("return",n(O.rC.VG.Fe));case 6:return r.abrupt("return",t(o));case 9:return r.prev=9,r.t0=r.catch(0),M.error(r.t0.message),r.abrupt("return",n(O.fR.rV));case 13:case"end":return r.stop()}}),r,null,[[0,9]])})));return function(e,t){return r.apply(this,arguments)}}())}function Yt(e,r){return new Promise(function(){var t=Ht(regeneratorRuntime.mark((function t(n,o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ye.updateOne({_id:e},{tfa:{recoverCodes:[],secret:{}},state:{tfaActivated:!1,banned:r.banned,emailConfirmed:r.emailConfirmed,reason:r.reason,banDate:r.banDate}});case 3:return t.abrupt("return",n());case 6:return t.prev=6,t.t0=t.catch(0),M.error(t.t0.message),t.abrupt("return",o(O.fR.rV));case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,r){return t.apply(this,arguments)}}())}Kt.get("/",Yr({level:0}),(function(e,r){var t=e.query.code;if(!t)return r.status(400).json(C(!0,O.fR.f1));Promise.resolve([]).then(function(){var r=Ht(regeneratorRuntime.mark((function r(t){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ft(e.user.id).then((function(e){return t.push(e),t})).catch((function(e){throw new Error("400:".concat(e))}));case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).then((function(e){var r=e[0].tfa.recoverCodes;if(r)return e.push(r),e;throw new Error("500:".concat(O.rC.VG.U8))})).then((function(e){if(e[1].some((function(e){if(Qe().compareSync(t,e))return!0})))return e;throw new Error("400:".concat(O.rC.VG.sg))})).then(function(){var t=Ht(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Yt(e.user.id,n[0].state).then((function(){return r.json(C(!1,O.rC.VG.JU))})).catch((function(e){throw new Error("500:".concat(e))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){var t=e.message.split(":");return r.status(t[0]).json(C(!0,t[1]))}))}));const Jt=Kt;var Wt=(0,n.Router)();Wt.use("/enable",Vt),Wt.use("/verify",Qt),Wt.use("/disable",Jt);const $t=Wt;var Zt=(0,n.Router)();Zt.use("/register",br),Zt.use("/confirm",Er),Zt.use("/login",Vr),Zt.use("/verify",Wr),Zt.use("/refresh",et),Zt.use("/change",Tt),Zt.use("/tfa",$t);const en=Zt,rn=require("swagger-ui-express");var tn=t.n(rn);const nn=JSON.parse('{"swagger":"2.0","info":{"description":"Documentação do GepetoServices. Todos os serviços feitos pelo Gepetojj, em um só lugar.","version":"","title":"GepetoServices","contact":{"name":"Gepetojj","email":"nmjoaopedro22@gmail.com"},"license":{"name":"MIT","url":"https://github.com/gepetojj/gepetoservices/blob/main/LICENSE"}},"host":"gepetoservices.herokuapp.com","basePath":"/api","tags":[{"name":"status","description":"Status das API\'s."},{"name":"storage","description":"Serviços de armazenamento de arquivos."},{"name":"users","description":"Serviços relacionados a usuários."},{"name":"translator","description":"Traduza textos."}],"schemes":["https"],"paths":{"/status":{"get":{"tags":["status"],"summary":"Receba o status das API\'s.","description":"","operationId":"status","produces":["application/json"],"responses":{"200":{"description":"Status obtido com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."},"storage":{"type":"object","description":"Status das API\'s do tipo storage.","properties":{"access":{"type":"object","description":"Status da API.","properties":{"statusCode":{"type":"integer","description":"Status http enviado pela API.","example":200},"timeToRespond":{"type":"integer","description":"Tempo de responsta da API em milisegundos.","example":1000},"classifiedAs":{"type":"string","description":"Classificação do status da API, basedo nos elementos anterioes.","example":"OK"}}},"delete":{"type":"object","description":"Status da API.","properties":{"statusCode":{"type":"integer","description":"Status http enviado pela API.","example":200},"timeToRespond":{"type":"integer","description":"Tempo de responsta da API em milisegundos.","example":1000},"classifiedAs":{"type":"string","description":"Classificação do status da API, basedo nos elementos anterioes.","example":"OK"}}},"upload":{"type":"object","description":"Status da API.","properties":{"statusCode":{"type":"integer","description":"Status http enviado pela API.","example":200},"timeToRespond":{"type":"integer","description":"Tempo de responsta da API em milisegundos.","example":1000},"classifiedAs":{"type":"string","description":"Classificação do status da API, basedo nos elementos anterioes.","example":"OK"}}}}},"translator":{"type":"object","description":"Status das API\'s do tipo translator.","properties":{"statusCode":{"type":"integer","description":"Status http enviado pela API.","example":200},"timeToRespond":{"type":"integer","description":"Tempo de responsta da API em milisegundos.","example":1000},"classifiedAs":{"type":"string","description":"Classificação do status da API, basedo nos elementos anterioes.","example":"OK"}}}}}},"500":{"description":"Erro do servidor.","schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":true},"message":{"type":"string","description":"Mensagem do servidor."}}}}}}},"/storage/access":{"get":{"tags":["storage"],"summary":"Acessa um arquivo guardado em nossa núvem.","description":"","operationId":"storageAccess","produces":["application/json"],"parameters":[{"name":"filename","in":"query","description":"Nome do arquivo guardado, informado quando o upload é feito.","required":true,"type":"string"}],"responses":{"200":{"description":"Arquivo acessado com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."},"file":{"type":"string","description":"Link do arquivo."}}}},"400":{"description":"Erro no request."},"500":{"description":"Erro do servidor."}}}},"/storage/delete":{"delete":{"tags":["storage"],"summary":"Deleta um arquivo seu da núvem.","description":"","operationId":"storageDelete","produces":["application/json"],"parameters":[{"name":"filename","in":"query","description":"Nome do arquivo guardado, informado quando o upload é feito.","required":true,"type":"string"}],"responses":{"200":{"description":"Arquivo deletado com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."}}}},"400":{"description":"Erro no request."},"500":{"description":"Erro do servidor."}}}},"/storage/upload":{"post":{"tags":["storage"],"summary":"Guarda um arquivo na nossa núvem.","description":"Os arquivos para que sejam guardados, devem ter até 5MB de tamanho, e só podem ser vídeos, imagens, áudios ou textos.","operationId":"storageUpload","consumes":["multipart/form-data"],"produces":["application/json"],"parameters":[{"name":"file","in":"formData","description":"Arquivo para ser guardado.","required":true,"type":"file"}],"responses":{"200":{"description":"Arquivo guardado com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."},"filename":{"type":"string","description":"Nome do arquivo que foi guardado."}}}},"400":{"description":"Erro no request."},"401":{"description":"Erro ao tentar deletar um arquivo que não é seu."},"500":{"description":"Erro do servidor."}}}},"/users/register":{"post":{"tags":["users"],"summary":"Cria um usuário.","description":"","operationId":"usersRegister","consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"user","in":"body","description":"Dados do usuário que será criado.","required":true,"schema":{"type":"object","properties":{"username":{"type":"string","description":"Nome do usuário."},"email":{"type":"string","description":"Email do usuário."},"password":{"type":"string","description":"Senha do usuário.","minimum":10},"passwordConfirm":{"type":"string","description":"Senha do usuário novamente.","minimum":10}}}},{"name":"X-From-App","in":"header","description":"Define de qual app este request vem.","type":"string","required":false}],"responses":{"200":{"description":"Usuário criado com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."}}}},"400":{"description":"Erro no request.","schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":true},"message":{"type":"string","description":"Mensagem do servidor."},"errors":{"type":"array","description":"Lista de erros.","items":{"type":"string"}}}}},"500":{"description":"Erro do servidor."}}}},"/users/login":{"post":{"tags":["users"],"summary":"Entra na sua conta.","description":"","operationId":"usersLogin","consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"user","in":"body","description":"Dados do usuário.","required":true,"schema":{"type":"object","properties":{"username":{"type":"string","description":"Nome do usuário."},"password":{"type":"string","description":"Senha do usuário.","minimum":10}}}},{"name":"X-From-App","in":"header","description":"Define de qual app este request vem.","type":"string","required":false}],"responses":{"200":{"description":"Logado com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."},"accessToken":{"type":"string","format":"jwt","description":"Token de acesso JWT. Válido por 15 minutos."}}}},"400":{"description":"Erro no request.","schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":true},"message":{"type":"string","description":"Mensagem do servidor."},"errors":{"type":"array","description":"Lista de erros.","items":{"type":"string"}}}}},"500":{"description":"Erro do servidor."}}}},"/users/verify":{"get":{"tags":["users"],"summary":"Retorna os dados não sensíveis da conta logada.","description":"Necessita do cookie \'refreshToken\', que é gerado pelo endpoint de login, quando finalizado com sucesso.","operationId":"usersVerify","consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"Authorization","in":"header","description":"Token JWT com prefix Bearer.","type":"string","format":"jwt","required":true},{"name":"X-From-App","in":"header","description":"Define de qual app este request vem.","type":"string","required":false}],"responses":{"200":{"description":"Dados retornados com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."},"data":{"type":"object","description":"Dados do usuário."}}}},"400":{"description":"Erro no request."},"401":{"description":"Erro ao não ter autorização para acessar o endpoint."},"500":{"description":"Erro do servidor."}}}},"/users/confirm":{"get":{"tags":["users"],"summary":"Confirma ações por meio de emails enviados pela API.","description":"","operationId":"usersConfirm","consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"t","in":"query","description":"Token JWT.","type":"string","format":"jwt","required":true}],"responses":{"200":{"description":"Email confirmado com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."}}}},"400":{"description":"Erro no request."},"401":{"description":"Erro ao não ter autorização para acessar o endpoint."},"500":{"description":"Erro do servidor."}}}},"/users/change/avatar":{"put":{"tags":["users"],"summary":"Muda o avatar da conta.","description":"Necessita do cookie \'refreshToken\', que é gerado pelo endpoint de login, quando finalizado com sucesso.","operationId":"usersChangeAvatar","consumes":["multipart/form-data"],"produces":["application/json"],"parameters":[{"name":"Authorization","in":"header","description":"Token JWT com prefix Bearer.","type":"string","format":"jwt","required":true},{"name":"X-From-App","in":"header","description":"Define de qual app este request vem.","type":"string","required":false},{"name":"file","in":"formData","description":"Novo avatar. Deve ser uma imagem de até 3MB, que vai ser redimencionada para 128x128 pixels.","required":true,"type":"file"}],"responses":{"200":{"description":"Avatar alterado com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."},"link":{"type":"string","description":"Link do avatar."}}}},"400":{"description":"Erro no request."},"401":{"description":"Erro ao não ter autorização para acessar o endpoint."},"500":{"description":"Erro do servidor."}}}},"/users/change/password":{"put":{"tags":["users"],"summary":"Muda a senha da conta.","description":"Necessita do cookie \'refreshToken\', que é gerado pelo endpoint de login, quando finalizado com sucesso.\\n\\nSe o endpoint retornar com código 200, o usuário deverá confirmar essa ação no email.","operationId":"usersChangePassword","consumes":["application/json"],"produces":["application/json"],"parameters":[{"name":"Authorization","in":"header","description":"Token JWT com prefix Bearer.","type":"string","format":"jwt","required":true},{"name":"X-From-App","in":"header","description":"Define de qual app este request vem.","type":"string","required":false},{"name":"password","in":"body","description":"Nova senha para ser alterada.","required":true,"schema":{"type":"object","properties":{"password":{"type":"string","description":"Senha atual do usuário.","minimum":10},"newPassword":{"type":"string","description":"Nova senha do usuário.","minimum":10},"newPasswordConfirm":{"type":"string","description":"Senha atual do usuário novamente.","minimum":10}}}}],"responses":{"200":{"description":"Senha alterada com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"string","description":"Mensagem do servidor."}}}},"400":{"description":"Erro no request."},"401":{"description":"Erro ao não ter autorização para acessar o endpoint."},"500":{"description":"Erro do servidor."}}}},"/translator":{"get":{"tags":["translator"],"summary":"Traduza textos entre línguas.","description":"","operationId":"translator","produces":["application/json"],"parameters":[{"name":"text","in":"query","description":"Texto para ser traduzido.","type":"string","required":true},{"name":"from","in":"query","description":"Língua original do texto, no formato iso-639","type":"string","required":false},{"name":"to","in":"query","description":"Língua para o texto ser traduzido, no formato iso-639","type":"string","required":true}],"responses":{"200":{"description":"Texto traduzido com sucesso.","headers":{"Retry-After":{"type":"integer","format":"float","description":"Tempo em milisegundos até o próximo request ser válido."},"X-RateLimit-Limit":{"type":"integer","format":"int32","description":"Limite total de requests disponíveis nesse endpoint."},"X-RateLimit-Remaining":{"type":"integer","format":"int32","description":"Quantos requests faltam para a API ficar limitada."},"X-RateLimit-Reset":{"type":"number","format":"date","description":"Quando o limite vai resetar. UTC-3."}},"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Se houve erro durante a execução da API.","example":false},"message":{"type":"object","description":"Resultado da tradução","properties":{"text":{"type":"string","description":"Texto traduzido."},"from":{"type":"object","properties":{"language":{"type":"object","properties":{"didYouMean":{"type":"boolean","description":"Se houve uma correção gramática na tradução final.","example":false},"iso":{"type":"string","description":"Língua do texto traduzido no formato iso-639."}}},"text":{"type":"object","properties":{"autoCorrected":{"type":"boolean","description":"Se o texto foi corrigido automaticamente.","example":false},"value":{"type":"string","description":"Texto corrigido, caso haja."},"didYouMean":{"type":"boolean","description":"Se houve uma correção gramática na texto original.","example":false}}}}}}}}}},"400":{"description":"Erro no request."},"500":{"description":"Erro do servidor."}}}}},"externalDocs":{"description":"Veja mais na wiki","url":"https://github.com/gepetojj/gepetoservices/wiki"}}');var on=(0,n.Router)();nn.info.version="2.2.6",on.use("/",tn().serve,tn().setup(nn));const an=on;function sn(e,r,t,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void t(e)}i.done?r(u):Promise.resolve(u).then(n,o)}var un=(0,n.Router)(),cn=Q.firestore().collection("ifal");un.post("/",function(){var e,r=(e=regeneratorRuntime.mark((function e(r,t){var n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.query.token,!(o=We().decode(n,{json:!0}))){e.next=13;break}e.prev=3,a=JSON.parse(o.sub),cn.doc().create({authToken:n,decodedToken:a,expires:o.exp,data:{fullName:a.nome,email:a.email,cpf:a.candidato.cpf,rg:a.candidato.rg,birthDate:a.candidato.aniversario,phoneNumber:a.candidato.telefone,address:{street:a.candidato.endereco.logradouro,neighborhood:a.candidato.endereco.bairro,houseNumber:a.candidato.endereco.numero,postalCode:a.candidato.endereco.cep,city:a.candidato.endereco.cidade.nome,state:a.candidato.endereco.cidade.estado.nome}}}).then((function(){return t.json(C(!1,"Ok."))})).catch((function(e){return M.error(e.message),t.status(500).json(C(!0,"Houve um erro, tente novamente."))})),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(3),e.abrupt("return",t.status(500).json(C(!0,"Houve um erro, tente novamente.")));case 11:e.next=14;break;case 13:return e.abrupt("return",t.status(400).json(C(!0,"Token não informado.")));case 14:case"end":return e.stop()}}),e,null,[[3,8]])})),function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function s(e){sn(a,n,o,s,i,"next",e)}function i(e){sn(a,n,o,s,i,"throw",e)}s(void 0)}))});return function(e,t){return r.apply(this,arguments)}}());const pn=un;var fn=(0,n.Router)();fn.use("/translator",N),fn.use("/storage",Ae),fn.use("/status",Xe),fn.use("/users",en),fn.use("/docs",an),fn.use("/ifal",pn);const dn=fn;function mn(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function ln(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?mn(Object(t),!0).forEach((function(r){hn(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):mn(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function hn(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}t(334).config();var vn=o()(),gn=process.env.PORT;R()().locale("pt-br"),R()().tz("America/Maceio"),vn.enable("trust proxy"),vn.use(y()()),vn.use(v()({maxAge:31536e3,includeSubDomains:!0,preload:!0})),vn.use(l()({hsts:!1,contentSecurityPolicy:{directives:ln(ln({},l().contentSecurityPolicy.getDefaultDirectives()),{},{"script-src":["'self'","'unsafe-eval'","'unsafe-inline'"]})}})),vn.use(u()({origin:"*"})),vn.use(p()()),vn.use((function(e,r,t){var n=(0,k.getClientIp)(e);e.headers["x-ip"]=n,t()})),vn.use((function(e,r,t){O.qQ.H.includes(e.path)?A.consume(e.headers["x-ip"]).then((function(e){var n=S(e,"minimized");return r.set(n),t()})).catch((function(e){var t=S(e,"minimized");return r.set(t),r.status(429).json(C(!0,O.qQ.r,{limit:"".concat(5," requests em ").concat(Math.floor(30)," minutos.")}))})):T.consume(e.headers["x-ip"]).then((function(e){var n=S(e);return r.set(n),t()})).catch((function(e){var t=S(e);return r.set(t),r.status(429).json(C(!0,O.qQ.r,{limit:"".concat(50," requests em ").concat(Math.floor(30)," minutos.")}))}))})),vn.use((0,s.urlencoded)({extended:!1})),vn.use((0,s.json)()),vn.use(b()({secret:process.env.COOKIE_SECRET,expires:R()().add(1,"day").toDate(),secure:!0,httpOnly:!0,signed:!0,sameSite:"lax"})),vn.use(d()({createParentPath:!0}));var yn=process.env.MONGO_URI;(0,a.connect)(yn,{useNewUrlParser:!0,useUnifiedTopology:!0,useCreateIndex:!0}),a.connection.on("error",(function(e){throw M.fatal("Erro com o MongoDB: ".concat(e.message))})),vn.use(o().static("build/public")),vn.use("/api",dn),vn.get("/",(function(e,r){r.send('\n      <!DOCTYPE html>\n      <html lang="pt-br">\n\t\t<head>\n\t\t\t<meta charset="UTF-8">\n\t\t\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t\t\t<title>GepetoServices</title>\n\t\t</head>\n\t\t<body>\n\t\t\t<div id="app">\n\t\t\t</div>\n\t\t\t<script src="bundleClient.js"><\/script>\n\t\t</body>\n      </html>\n    ')})),vn.use((function(e,r){return r.status(404).json(C(!0,O.DH.v6,{method:e.method,endpoint:e.path}))})),vn.listen(gn,"0.0.0.0",(function(){M.info(O.DH.U6)}))},334:e=>{e.exports=require("dotenv")}},r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{}};return e[n](o,o.exports,t),o.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),t(116)})();